# ğŸ“º YOUTUBE VIEWS - 5 EMAIL SEQUENCE
# 
# Automated email campaign to promote YouTube Views:
# "10+ AI tools to grow your YouTube channel faster"
#
# Usage:
#   - Manual trigger with sequence number selection
#   - Preview mode to test emails before production sends

name: YouTube Views Sequence (5 Emails)

on:
  workflow_dispatch:
    inputs:
      sequence_number:
        description: 'Sequence Email Number (1-5)'
        required: true
        default: '1'
        type: choice
        options:
          - '1'
          - '2'
          - '3'
          - '4'
          - '5'
      max_emails:
        description: 'Maximum number of emails to send'
        required: false
        default: '50'
        type: string
      preview_mode:
        description: 'Preview mode (sends to test email only)'
        required: false
        default: 'false'
        type: choice
        options:
          - 'false'
          - 'true'

  schedule:
    # Send sequence emails every Wednesday and Saturday at 3pm UTC
    - cron: '0 15 * * 3,6'

jobs:
  send-youtube-views-sequence:
    name: 'ğŸ“º YouTube Views Sequence Email #${{ github.event.inputs.sequence_number || 1 }}'
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ“¦ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: ğŸ“š Install Dependencies
        run: |
          npm install pg resend dotenv

      - name: ğŸ“§ Send YouTube Views Sequence Email
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "â•‘   ğŸ“º YOUTUBE VIEWS - EMAIL SEQUENCE                         â•‘"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ“§ Sequence Number: ${{ github.event.inputs.sequence_number || '1' }}"
          echo "ğŸ“Š Max Emails: ${{ github.event.inputs.max_emails || '50' }}"
          echo "ğŸ”„ Preview Mode: ${{ github.event.inputs.preview_mode || 'false' }}"
          echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
          
          node scripts/youtube-views-sequence-sender.cjs \
            --sequence=${{ github.event.inputs.sequence_number || '1' }} \
            --max=${{ github.event.inputs.max_emails || '50' }} \
            --preview=${{ github.event.inputs.preview_mode || 'false' }}
        env:
          SUPABASE_CONNECTION_STRING: ${{ secrets.SUPABASE_CONNECTION_STRING }}
          BREVO_API_KEY: ${{ secrets.BREVO_API_KEY }}
          PREVIEW_MODE: ${{ github.event.inputs.preview_mode || 'false' }}

      - name: âœ… Sequence Complete
        run: |
          echo ""
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "â•‘   âœ… YOUTUBE VIEWS SEQUENCE EMAIL SENT SUCCESSFULLY         â•‘"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "ğŸ“§ Email: #${{ github.event.inputs.sequence_number || '1' }} of 5"
          echo "ğŸ“º Focus: YouTube Views AI Growth Tools"
          echo "ğŸ”— CTA: https://boostifymusic.com/youtube-views"
          echo ""
          echo "ğŸ“‹ Sequence Overview:"
          echo "   1ï¸âƒ£  The Problem & Solution - Why Videos Fail"
          echo "   2ï¸âƒ£  The Tools - 10+ AI Growth Tools"
          echo "   3ï¸âƒ£  Pre-Launch Score - Predict Before Publishing"
          echo "   4ï¸âƒ£  Success Stories - Real Creator Results"
          echo "   5ï¸âƒ£  Final Push - FREE Forever Access"
          echo ""
